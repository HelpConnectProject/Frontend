<div class="organizations-container hc-page">
    <div class="page-header">
        <h1 class="page-title">Saját szervezetek</h1>
        <div class="header-actions">
            <a class="link-btn" routerLink="/organizations">Összes szervezet</a>
            @if (!showForm) {
                <button class="primary-btn create-btn" type="button" (click)="startCreate()">
                    Új szervezet hozzáadása
                </button>
            }
        </div>
    </div>

    @if (showForm) {
    <section class="form-wrapper">
        <div class="form-header">
            <h2>Új szervezet létrehozása</h2>
            <button class="ghost-btn" type="button" (click)="cancelForm()">Mégse</button>
        </div>
        <div class="form-error">{{ formError }}</div>
        <form class="organization-form" [formGroup]="organizationForm" (ngSubmit)="submitForm()">
            <div class="form-grid">
                <label>
                    Név
                    <input formControlName="name" />
                </label>
                <label>
                    Kategória
                    <select formControlName="category">
                        <option value="">Válassz kategóriát…</option>
                        <option>Szociális és humanitárius szervezetek</option>
                        <option>Egészségügyi szervezetek</option>
                        <option>Oktatási és tudományos szervezetek</option>
                        <option>Környezetvédelmi szervezetek</option>
                        <option>Emberi jogi és jogvédő szervezetek</option>
                        <option>Kulturális és művészeti szervezetek</option>
                        <option>Sport és szabadidős szervezetek</option>
                        <option>Ifjúsági és közösségfejlesztő szervezetek</option>
                        <option>Érdekvédelmi és szakmai szervezetek</option>
                    </select>
                </label>
                <label>
                    Telefonszám
                    <input type="tel" formControlName="phone" placeholder="+36 30 111 1111" />
                    <span *ngIf="organizationForm.get('phone')?.invalid && organizationForm.get('phone')?.touched" class="input-error">Hibás telefonszám formátum</span>
                </label>
                <label>
                    Email
                    <input formControlName="email" />
                    <span *ngIf="organizationForm.get('email')?.invalid && organizationForm.get('email')?.touched" class="input-error">Hibás email formátum</span>
                </label>
                <label>
                    Cím
                    <input formControlName="address" />
                </label>
                <label>
                    Weboldal
                    <input formControlName="website" />
                    <span *ngIf="organizationForm.get('website')?.invalid && organizationForm.get('website')?.touched" class="input-error">Hibás weboldal formátum</span>
                </label>
                <label>
                    Bankszámla
                    <input formControlName="bank_account" placeholder="pl:11112222-33334444" />
                    <span *ngIf="organizationForm.get('bank_account')?.touched && organizationForm.get('bank_account')?.errors?.['bankAccount']" class="input-error">Hibás bankszámla formátum</span>
                </label>
            </div>
            <label class="full-width">
                Leírás
                <textarea class="about-edit-textarea about-edit-textarea--large" formControlName="description" rows="12"></textarea>
            </label>
            <div class="form-actions">
                <button class="primary-btn" type="submit" [disabled]="submitting">
                    Szervezet létrehozása
                </button>
                <button class="ghost-btn" type="button" (click)="clearFormFields()">Űrlap törlése</button>
            </div>
        </form>
    </section>
    }

    <div class="cards-grid">
        @for (org of organizations; track org.id) {
            <div class="org-card">
                <div class="card-media">
                    <img [src]="categoryImageFor(org.category)" [alt]="org.category || org.name" />
                </div>
                <div class="card-header">
                    <a class="card-main" [routerLink]="['/aboutorganization', org.id]" [queryParams]="{ own: 1 }">
                        <div class="card-info-summary">
                            <h3 class="card-title">{{ org.name }}</h3>
                            @if (org.category) {
                                <p class="card-category">{{ org.category }}</p>
                            }
                        </div>
                    </a>
                </div>
            </div>
        }
    </div>

    @if (!organizations || organizations.length === 0) {
        <div class="empty-state">
            <p>Még nincs saját szervezet.</p>
        </div>
    }
</div>