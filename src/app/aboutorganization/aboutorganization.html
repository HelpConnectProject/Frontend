
@if (!loading && org) {
	<div class="about-org-modern">
		<nav class="about-org-nav">
                <a (click)="reset()" routerLink="/organizations" class="back-btn">Vissza a szervezetekhez</a>
           
		</nav>
		<section class="about-org-main">
			<div class="about-org-logo-modern">
				@if (org.logo) {
					<img [src]="org.logo" [alt]="org.name" />
				} @else {
					<span class="logo-placeholder-modern">{{ org.name.substring(0, 2).toUpperCase() }}</span>
				}
			</div>
			<div class="about-org-info-modern">
				<h1 class="about-org-title-modern">{{ org.name }}</h1>
				@if (org.category) {
					<span class="about-org-category-modern">{{ org.category }}</span>
				}
			</div>
			<div class="about-org-details-modern">
				<div class="about-org-detail-row">
					<span class="detail-label">Email:</span>
					<span class="detail-value">{{ org.email }}</span>
				</div>
				@if (org.description) {
					<div class="about-org-detail-row">
						<span class="detail-label">Leírás:</span>
						<span class="detail-value">{{ org.description }}</span>
					</div>
				}
				@if (org.phone) {
					<div class="about-org-detail-row">
						<span class="detail-label">Telefonszám:</span>
						<span class="detail-value">{{ org.phone }}</span>
					</div>
				}
				@if (org.address) {
					<div class="about-org-detail-row">
						<span class="detail-label">Cím:</span>
						<span class="detail-value">{{ org.address }}</span>
					</div>
				}
				@if (org.bank_account) {
					<div class="about-org-detail-row">
						<span class="detail-label">Bankszámla:</span>
						<span class="detail-value bank-account-modern">{{ org.bank_account }}</span>
					</div>
				}
				@if (org.website) {
					<div class="about-org-detail-row">
						<span class="detail-label">Weboldal:</span>
						<span class="detail-value">
							<a [href]="org.website" target="_blank" rel="noopener noreferrer">{{ org.website }}</a>
						</span>
					</div>
				}

				<section class="past-events-section">
					<h2 class="past-events-title">Múltbéli események</h2>
					@if (events && events.length > 0) {
						<div class="past-events-list">
							@for(event of events; track event.id) {
								<article class="event-feedback-block">
									<div class="event-card-header">
										<div class="event-card-title">{{ event.title }}</div>
										<div class="event-card-meta">{{ event.date | date:'yyyy.MM.dd. HH:mm' }}</div>
									</div>
							@if(event.feedbacks && event.feedbacks.length > 0) {
								<div class="event-feedback-list">
									<b>Visszajelzések:</b><br>
									@for(feedback of event.feedbacks; track feedback.id) {
										<div class="feedback-item">
											<div class="feedback-left">
												<div class="feedback-text">
													<span class="feedback-comment">{{feedback.comment}}</span>
													@if (feedback.updated_at) {
														<span class="feedback-date">{{ feedback.updated_at | date:'yyyy.MM.dd. HH:mm' }}</span>
													}
												</div>
												<span class="star-rating-static feedback-stars">
													@for(star of getStars(5); track star) {
														<span class="star" [class.filled]="star <= feedback.rating">&#9733;</span>
													}
												</span>
											</div>
											@if (canDeleteFeedback(feedback)) {
												<div class="feedback-right">
													<button type="button" class="action-btn delete" (click)="deleteFeedback(feedback.id)">Törlés</button>
												</div>
											}
										</div>
									}
								</div>
							} @else {
								<span>Nincs visszajelzés.</span><br>
							}
							<form (submit)="addFeedback(event.id, $event)" class="event-feedback-form">
								<input type="text" name="comment" placeholder="Komment" required class="feedback-input">
								<span class="star-rating">
									@for(star of [5,4,3,2,1]; track star) {
										<input type="radio" id="star-{{event.id}}-{{star}}" name="rating" value="{{star}}" required>
										<label for="star-{{event.id}}-{{star}}" class="star">&#9733;</label>
									}
								</span>
								<button type="submit" class="feedback-submit-btn">Visszajelzés küldése</button>
							</form>
							</article>
							}
						</div>
					} @else {
						<p class="past-events-empty">Nincs még múltbeli esemény.</p>
					}
				</section>
			</div>
		</section>
	</div>
}
@if (!loading && !org) {
	<div class="about-org-notfound">
		<p>A szervezet nem található.</p>
	</div>
}
@if (loading) {
	<div class="about-org-loading">
		<p>Betöltés...</p>
	</div>
}
